# 开发任务：DOCX 文档批量同步更新软件

## 📋 任务概述
开发一个 Windows 桌面应用程序，能够批量修改约 100 个 Word 文档的相同内容，并严格保持格式一致性。

## 🎯 具体需求
1. **兼容性要求**：
   - 支持 Windows 7, Windows 10, Windows 11
   - 打包为独立可执行文件（无需安装 Python）

2. **核心功能**：
   - 批量选择多个 DOCX 文件（约 100 份）
   - 定义需要修改的内容（文本和表格）
   - 一键批量替换所有文档中的目标内容
   - 严格保持原有格式（字体、颜色、大小、段落样式等）
   - 支持表格内容的修改，保持表格结构
   - 保留自动段落、编号、交叉引用等高级格式

3. **用户界面**：
   - 简洁易用的 GUI 界面
   - 文件选择功能（多选/文件夹）
   - 内容替换规则配置界面
   - 进度显示和日志输出

## 🔧 技术规范
- 语言/框架: Python 3.8+ (确保 Win7 兼容性)
- 主要依赖: python-docx (文档处理), PyQt5 (GUI), PyInstaller (打包)
- 代码风格: PEP 8 + 类型提示
- 测试要求: 功能测试 + 格式保真度测试

## 📂 项目结构
```
docx-batch-updater/
├── src/
│   ├── main.py              # 程序入口
│   ├── gui/
│   │   ├── __init__.py
│   │   ├── main_window.py   # 主窗口
│   │   └── widgets.py       # 自定义组件
│   ├── core/
│   │   ├── __init__.py
│   │   ├── docx_processor.py  # 文档处理核心
│   │   └── batch_processor.py  # 批量处理逻辑
│   └── utils/
│       ├── __init__.py
│       └── format_preserver.py  # 格式保持工具
├── requirements.txt
├── README.md
└── build.bat               # 打包脚本
```

## ⚙️ 环境配置
需要安装的依赖：
```
python-docx==0.8.11
PyQt5==5.15.9
PyInstaller==5.13.0
```

## ✅ 验收标准
- [ ] 能批量选择和处理 100+ DOCX 文件
- [ ] 文本替换后格式完全一致（测试用例覆盖）
- [ ] 表格内容能正确更新且结构不变
- [ ] 自动段落、编号等格式保留完整
- [ ] GUI 界面友好，操作流畅
- [ ] 打包生成的 exe 能在 Win7/10/11 上正常运行
- [ ] 包含详细的使用说明文档
- [ ] 代码符合 PEP 8 规范

## 🚨 注意事项
- **格式保真是核心**：必须使用 python-docx 的 run 级别操作，不能破坏段落格式
- **性能考虑**：100 份文档处理时间应控制在合理范围（<5分钟）
- **错误处理**：对损坏的文档要有友好的错误提示
- **备份机制**：建议自动备份原文件
- **兼容性测试**：在不同 Windows 版本上测试打包后的 exe

## 📝 提交要求
- Commit message 格式: feat: implement docx batch updater with GUI
- 提交完整的源码、配置文件、构建脚本和文档
- 包含测试用例和测试文档
- 提供打包好的 exe 文件（如果可能）

## 🔍 关键技术要点
1. **格式保持**：使用 python-docx 的 runs 操作，避免直接替换整个段落
2. **表格处理**：遍历所有表格和单元格进行精确匹配和替换
3. **批量处理**：使用多线程或异步处理提升性能
4. **打包配置**：PyInstaller 需要正确配置 PyQt5 的依赖
5. **进度反馈**：实时显示处理进度，提升用户体验
